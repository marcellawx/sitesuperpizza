<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Super Pizza - Card√°pio Irresist√≠vel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    .tab-active { border-bottom: 4px solid #ef4444; color: #ef4444; font-weight: bold; }
    .custom-scroll::-webkit-scrollbar { width: 8px; }
    .custom-scroll::-webkit-scrollbar-track { background: #fef3c7; }
    .custom-scroll::-webkit-scrollbar-thumb { background-color: #f87171; border-radius: 10px; border: 2px solid #fef3c7; }
    .cart-item-enter { animation: slide-in 0.3s ease-out forwards; }
    @keyframes slide-in { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    .modal-enter { animation: fade-in 0.3s ease-out forwards; }
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    button { transition: transform 0.1s ease-in-out, background-color 0.2s; }
    button:active { transform: scale(0.95); }
    button:disabled { background-color: #9ca3af !important; cursor: not-allowed !important; opacity: 0.7; }
    .accordion-toggle .fa-chevron-down { transition: transform 0.2s ease-in-out; }
    .accordion-toggle.open .fa-chevron-down { transform: rotate(180deg); }
  </style>
</head>
<body class="bg-gradient-to-br from-yellow-50 via-red-50 to-yellow-100 min-h-screen flex flex-col font-sans">

<header id="header" class="bg-red-700 text-white p-4 shadow-xl">
  <div class="max-w-7xl mx-auto flex flex-col items-center">
    <div class="flex items-center gap-3">
      <i class="fas fa-pizza-slice text-3xl text-yellow-300"></i>
      <h1 class="text-3xl font-extrabold" style="font-family: 'Titan One', cursive;">Super Pizza</h1>
    </div>
    <div class="mt-3 text-center text-xs">
      <p class="font-semibold"><i class="fas fa-motorcycle mr-2 text-yellow-300"></i>Entrega gr√°tis acima de R$ 35,00!</p>
      <p><i class="fas fa-credit-card mr-2 text-yellow-300"></i>Aceitamos cart√µes de refei√ß√£o e alimenta√ß√£o</p>
    </div>
  </div>
</header>

<main class="flex-grow max-w-7xl mx-auto p-2 w-full">
  <nav class="mb-6 flex flex-wrap justify-center border-b-2 border-red-200">
    <button class="tab-button tab-active px-3 py-2 font-semibold text-sm" data-tab="promocoes">Promo√ß√µes üî•</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="pizzas">Pizzas üçï</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="massas">Massas üçù</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="hamburgueres">Hamb√∫rgueres üçî</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="esfihas">Esfihas ü•ü</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="combos">Combos üçü</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="bebidas">Bebidas ü•§</button>
    <button class="tab-button px-3 py-2 font-semibold text-sm" data-tab="contato">Contato üìû</button>
  </nav>
  
  <div>
    <section id="promocoes" class="tab-content block"></section>
    <section id="pizzas" class="tab-content hidden"></section>
    <section id="massas" class="tab-content hidden"></section>
    <section id="hamburgueres" class="tab-content hidden"></section>
    <section id="esfihas" class="tab-content hidden"></section>
    <section id="combos" class="tab-content hidden"></section>
    <section id="bebidas" class="tab-content hidden"></section>
    <section id="contato" class="tab-content hidden"></section>
  </div>
</main>

<button id="floatingCartButton" class="hidden fixed bottom-4 right-4 bg-red-600 text-white p-3 rounded-full shadow-lg z-40 flex items-center">
  <i class="fas fa-shopping-cart text-xl"></i>
  <span id="floatingCartTotal" class="ml-2 bg-yellow-300 text-red-700 text-xs font-bold rounded-full px-2 py-1">R$ 0,00</span>
</button>

<div id="cartModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4 modal-enter">
  <div class="bg-white rounded-lg shadow-2xl p-4 w-full max-w-md max-h-[90vh] flex flex-col">
    <div class="flex justify-between items-center border-b-2 border-red-200 pb-2 mb-4"><h3 class="text-xl font-bold text-red-700 flex items-center gap-3"><i class="fas fa-shopping-cart text-red-600"></i> Meu Pedido</h3><button id="closeCartModal" class="text-gray-500 hover:text-red-600 text-2xl">&times;</button></div>
    <div id="cartItems" class="flex-grow overflow-y-auto custom-scroll mb-4"></div>
    <div class="border-t-2 border-red-200 pt-4"><div class="mb-4"><div class="flex gap-2"><input type="text" id="couponInput" placeholder="Tem um cupom?" class="w-full p-2 border border-gray-300 rounded-md text-sm"><button id="applyCouponBtn" class="bg-gray-800 text-white px-4 rounded-md hover:bg-gray-700 text-sm font-bold">Aplicar</button></div><p id="couponMessage" class="text-xs mt-1"></p></div><div class="space-y-1 text-sm"><div class="flex justify-between items-center"><span class="text-gray-600">Subtotal:</span><span id="cartSubtotal" class="text-gray-800 font-semibold">R$ 0,00</span></div><div id="discountContainer" class="hidden flex justify-between items-center text-green-600"><span class="font-semibold">Desconto:</span><span id="discountAmount" class="font-semibold">- R$ 0,00</span></div><div id="deliveryFeeContainer" class="hidden flex justify-between items-center"><span class="text-gray-600">Taxa de Entrega:</span><span id="cartDeliveryFee" class="font-semibold text-gray-800">R$ 8,00</span></div><div class="flex justify-between items-center border-t pt-2 mt-2"><span class="text-lg font-bold text-gray-800">Total:</span><span id="cartTotal" class="text-xl font-bold text-red-700">R$ 0,00</span></div></div><button id="checkoutButton" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg text-lg mt-4" disabled><i class="fab fa-whatsapp"></i> Concluir Pedido</button></div>
  </div>
</div>
<div id="checkoutModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4 modal-enter">
  <div class="bg-white rounded-lg shadow-2xl p-4 w-full max-w-md max-h-[90vh] overflow-y-auto custom-scroll">
    <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">Quase l√°! Faltam seus dados...</h2>
    <form id="customerInfoForm"><div class="mb-3"><label for="customerName" class="block text-gray-700 text-sm font-bold mb-1">Nome Completo:</label><input type="text" id="customerName" class="shadow-sm appearance-none border rounded w-full py-2 px-3 text-gray-700" required></div><div class="grid grid-cols-1 gap-3 mb-3"><div><label for="customerAddress" class="block text-gray-700 text-sm font-bold mb-1">Endere√ßo (Rua e N¬∫):</label><input type="text" id="customerAddress" class="shadow-sm appearance-none border rounded w-full py-2 px-3 text-gray-700" required></div><div><label for="customerNeighborhood" class="block text-gray-700 text-sm font-bold mb-1">Bairro:</label><input type="text" id="customerNeighborhood" class="shadow-sm appearance-none border rounded w-full py-2 px-3 text-gray-700" required></div></div><div class="mb-3"><label for="customerObs" class="block text-gray-700 text-sm font-bold mb-1">Observa√ß√µes (opcional):</label><textarea id="customerObs" class="shadow-sm appearance-none border rounded w-full py-2 px-3 text-gray-700" rows="2" placeholder="Ex: sem cebola, etc."></textarea></div><div class="border p-3 rounded-lg mb-4"><p class="block text-gray-700 text-sm font-bold mb-2">Sach√™s (Cortesia)</p><div class="flex items-center justify-around"><div><label for="ketchupQty" class="text-sm">Ketchup:</label><input type="number" id="ketchupQty" min="0" max="10" value="0" class="w-16 text-center border rounded"></div><div><label for="mustardQty" class="text-sm">Mostarda:</label><input type="number" id="mustardQty" min="0" max="10" value="0" class="w-16 text-center border rounded"></div></div></div><div class="mb-4"><label for="paymentMethod" class="block text-gray-700 text-sm font-bold mb-1">Forma de Pagamento:</label><select id="paymentMethod" class="shadow-sm appearance-none border rounded w-full py-2 px-3 text-gray-700" required><option value="" disabled selected>Selecione</option><option value="Vale Refei√ß√£o/Alimenta√ß√£o">Vale Refei√ß√£o/Alimenta√ß√£o</option><option value="PIX">PIX</option><option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option><option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option><option value="Dinheiro">Dinheiro</option></select></div><div class="flex items-center justify-between gap-4 mt-6"><button type="button" id="cancelButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg w-1/2">Cancelar</button><button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg w-1/2">Confirmar</button></div></form>
  </div>
</div>
<div id="promoModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4 modal-enter">
  <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] flex flex-col">
    <h2 id="promoModalTitle" class="text-xl font-bold text-gray-800 mb-4 text-center"></h2><form id="promoForm" class="flex-grow overflow-y-auto custom-scroll pr-2"><div id="promoSelectionContainer" class="space-y-6"></div></form><div class="mt-4 pt-4 border-t"><p class="text-xl font-bold text-red-700 text-center">Total: R$ <span id="promoTotal">0,00</span></p><div class="flex items-center justify-between gap-4 mt-4"><button type="button" id="cancelPromo" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg w-1/2">Cancelar</button><button type="submit" form="promoForm" id="addPromoBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg w-1/2">Adicionar</button></div></div>
  </div>
</div>
<div id="massaModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4 modal-enter">
  <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-xl max-h-[90vh] flex flex-col">
    <h2 id="massaModalTitle" class="text-xl font-bold text-gray-800 mb-4 text-center"></h2><form id="massaForm" class="flex-grow overflow-y-auto custom-scroll pr-2"><div id="massaSelectionContainer" class="space-y-6"></div></form><div class="mt-4 pt-4 border-t"><p class="text-xl font-bold text-red-700 text-center">Total: R$ <span id="massaTotal">0,00</span></p><div class="flex items-center justify-between gap-4 mt-4"><button type="button" id="cancelMassa" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg w-1/2">Cancelar</button><button type="submit" form="massaForm" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg w-1/2">Adicionar</button></div></div>
  </div>
</div>
<div id="esfihaComboModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4 modal-enter">
  <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] flex flex-col">
    <h2 id="esfihaComboModalTitle" class="text-xl font-bold text-gray-800 mb-4 text-center"></h2><form id="esfihaComboForm" class="flex-grow overflow-y-auto custom-scroll pr-2"><div id="esfihaComboSelectionContainer" class="space-y-4"></div><div id="esfihaComboSodaContainer" class="mt-6 space-y-4"></div></form><div class="mt-4 pt-4 border-t"><div class="p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 rounded-lg"><p>Selecionadas: <span id="esfihaCounter">0</span> de <span id="esfihaTotalQty">0</span></p></div><p id="esfihaWarning" class="text-red-600 text-sm mt-2 hidden text-center font-bold"></p><p class="text-xl font-bold text-red-700 text-center mt-4">Total: R$ <span id="esfihaComboTotal">0,00</span></p><div class="flex items-center justify-between gap-4 mt-4"><button type="button" id="cancelEsfihaCombo" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg w-1/2">Cancelar</button><button type="submit" form="esfihaComboForm" id="addEsfihaComboBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg w-1/2">Adicionar</button></div></div>
  </div>
</div>

<footer class="bg-red-800 text-yellow-100 p-6 mt-12">
  <div class="max-w-7xl mx-auto text-center"><div class="flex justify-center items-center gap-4 mb-4"><img src="https://i.imgur.com/83S4Y7g.png" alt="Sodexo" class="h-6"><img src="https://i.imgur.com/kM3T1fS.png" alt="VR Benef√≠cios" class="h-8"></div><p class="font-semibold">Super Pizza &copy; 2025</p><p class="text-sm italic mt-2">"O Senhor √© o meu pastor e nada me faltar√°"</p></div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    try {
        const WHATSAPP_NUMBER = '5521981417594';

        const data = {
            refrigerantesPromo: [ { nome: 'Guaran√° Antarctica 1.5L (Gr√°tis)', precoAdicional: 0 }, { nome: 'Kuat 2L (Gr√°tis)', precoAdicional: 0 }, { nome: 'Pepsi 1.5L (Gr√°tis)', precoAdicional: 0 }, { nome: 'Coca-Cola 2L', precoAdicional: 12.00 }, { nome: 'Pepsi 2L', precoAdicional: 5.00 }, { nome: 'Guaran√° Antarctica 2L', precoAdicional: 5.00 } ],
            massaSizes: [ { nome: 'Por√ß√£o Individual (400g)', preco: 34.90 }, { nome: 'Por√ß√£o Fam√≠lia (1kg)', preco: 59.90 } ],
            proteinasMassas: [ { nome: 'Presunto', precoAdicional: 0 }, { nome: 'Carne Mo√≠da', precoAdicional: 0 }, { nome: 'Frango Desfiado', precoAdicional: 0 }, { nome: 'Carne Seca Premium', precoAdicional: 10.00 }, { nome: 'Camar√£o Selecionado', precoAdicional: 10.00 }, { nome: 'Bacalhau Nobre', precoAdicional: 10.00 } ],
            ingredientesMassas: [ { nome: 'Alho Frito', precoAdicional: 1.50 }, { nome: 'Atum', precoAdicional: 3.50 }, { nome: 'Bacon Crocante', precoAdicional: 3.50 }, { nome: 'Calabresa Fatiada', precoAdicional: 2.50 }, { nome: 'Cebola Roxa', precoAdicional: 1.50 }, { nome: 'Lombo Canadense', precoAdicional: 3.50 }, { nome: 'Ovo de Codorna', precoAdicional: 1.50 }, { nome: 'Palmito', precoAdicional: 3.50 }, { nome: 'Presunto', precoAdicional: 2.50 }, { nome: 'Salaminho Italiano', precoAdicional: 3.50 }, { nome: 'Tomate Seco', precoAdicional: 3.50 } ],
            molhosMassas: [ { nome: 'Molho ao Sugo Artesanal' }, { nome: 'Molho Branco Cremoso' }, { nome: 'Molho Quatro Queijos' } ],
            
            promocoes: [ 
                { id: 'promo-familia', nome: 'Combo Fam√≠lia Feliz', desc: 'Uma pizza Fam√≠lia (at√© 2 sabores), uma pizza doce individual e um refrigerante para celebrar!', preco: 90.00, isCustomizable: true, pizzas: [{ type: 'salgada', size: 'Fam√≠lia', maxSabores: 2 }], includesSweet: true, includesSoda: true }, 
                { id: 'promo-gigante', nome: 'Combo Gigante Imbat√≠vel', desc: 'Uma pizza Gigante (at√© 3 sabores), uma pizza doce individual e um refrigerante. A fome n√£o tem chance!', preco: 110.00, preco_antigo: 120.00, isCustomizable: true, pizzas: [{ type: 'salgada', size: 'Gigante', maxSabores: 3 }], includesSweet: true, includesSoda: true },
                { id: 'promo-2medias', nome: 'Dose Dupla: 2 M√©dias + 1 Doce', desc: 'Duas pizzas M√©dias (2 sabores cada) e ganhe uma brotinho doce para fechar com chave de ouro.', preco: 100.00, isCustomizable: true, pizzas: [{ type: 'salgada', size: 'M√©dia 1', maxSabores: 2 }, { type: 'salgada', size: 'M√©dia 2', maxSabores: 2 }], includesSweet: true },
                { id: 'promo-media', nome: 'Pizza M√©dia Premiada', desc: 'Sua pizza m√©dia preferida com um pre√ßo que √© um verdadeiro presente. Aproveite!', preco: 52.00, preco_antigo: 60.00, isCustomizable: true, pizzas: [{ type: 'salgada', size: 'M√©dia', maxSabores: 2 }] }, 
                { id: 'promo-slim', nome: 'Promo Slim Gigante (47 cm)', desc: 'Todo o sabor em tamanho gigante com um desconto incr√≠vel. Perfeita para dividir!', preco: 85.00, preco_antigo: 100.00, isCustomizable: true, pizzas: [{ type: 'salgada', size: 'Gigante', maxSabores: 3 }] },
                { id: 'promo-combo-caixa', nome: 'Caixa Combo da Galera', desc: 'Ideal para a galera! 4 X-Tudo caprichados, 5 past√©is crocantes e batata com cheddar e bacon.', preco: 90.00, preco_antigo: 120.00, isCustomizable: false }
            ],
            
            pizzas: {
                tamanhos: [ { nome: 'Individual (26cm)', preco: 30.00, maxSabores: 2, sodasInclusas: 0 }, { nome: 'M√©dia (32cm)', preco: 50.00, maxSabores: 2, sodasInclusas: 0 }, { nome: 'Fam√≠lia (36cm)', preco: 75.00, maxSabores: 2, sodasInclusas: 1 }, { nome: 'Gigante (47cm)', preco: 90.00, maxSabores: 3, sodasInclusas: 1 }, { nome: 'Mega (70cm)', preco: 199.00, maxSabores: 5, sodasInclusas: 2 } ],
                bordas: [ { nome: 'Sem Borda', precoPadrao: 0.00 }, { nome: 'Catupiry Original', precoPadrao: 10.00, precoMega: 15.00, precoMedia: 7.00, precoIndividual: 5.00 }, { nome: 'Cheddar Cremoso', precoPadrao: 10.00, precoMega: 15.00, precoMedia: 7.00, precoIndividual: 5.00 }, { nome: 'Cream Cheese Philadelphia', precoPadrao: 12.00, precoMega: 17.00, precoMedia: 9.00, precoIndividual: 7.00 }, { nome: 'Goiabada Casc√£o', precoPadrao: 12.00, precoMega: 17.00, precoMedia: 9.00, precoIndividual: 7.00 }, { nome: 'Doce de Leite Argentino', precoPadrao: 12.00, precoMega: 17.00, precoMedia: 9.00, precoIndividual: 7.00 } ],
                saboresSalgados: [ "Americana", "Atum", "Alho", "Bacon", "Bacalhau", "Benevento", "Calabresa", "Cebola", "Carioca", "Capricciosa", "Frango com Catupiry", "Frango com Cheddar", "La Pizza", "Marguerita", "Moda da Casa", "Mussarela", "Moda da Casa 2", "Napolitana", "Ovo", "Palmito", "Pizza de Batata", "Portuguesa", "4 Queijos", "Super Pizza", "Siciliana", "Tomate Seco", "Tropicaliente", "Lombo Canadense", "Presunto", "Salaminho" ],
                saboresDoces: [ "Banana com Canela", "Cocada Cremosa", "Prest√≠gio", "Romeu & Julieta" ]
            },
            
            massas: [ 
                { id: 'massa-1', nome: 'Lasanha √† Bolonhesa', desc: 'Monte sua lasanha com camadas generosas de sabor, do seu jeito!', isCustomizable: true }, 
                { id: 'massa-2', nome: 'Capeletti Fresco', desc: 'Delicados capelettis esperando sua combina√ß√£o perfeita de molho e recheio.', isCustomizable: true },
                { id: 'massa-3', nome: 'Raviolli Artesanal', desc: 'Nossos raviollis recheados s√£o a base para uma refei√ß√£o inesquec√≠vel. Personalize!', isCustomizable: true },
                { id: 'massa-4', nome: 'Espaguete Al Dente', desc: 'O cl√°ssico espaguete italiano pronto para receber seus ingredientes favoritos.', isCustomizable: true },
                { id: 'massa-5', nome: 'Talharim da Nona', desc: 'Uma massa fresca e leve que combina com tudo. Crie sua obra-prima!', isCustomizable: true },
                { id: 'massa-6', nome: 'Nhoque da Fortuna', desc: 'Dizem que d√° sorte! Monte seu nhoque com os melhores acompanhamentos.', isCustomizable: true },
                { id: 'massa-7', nome: 'Penne ao seu Estilo', desc: 'A versatilidade do penne para voc√™ criar uma combina√ß√£o de sabores √∫nica.', isCustomizable: true } 
            ],

            hamburgueres: [ 
                { id: 'hamb-1', nome: 'X-Duplo Monstro', desc: 'Duas carnes, dois ovos, e tudo que tem direito em dobro. Encaras?', preco: 17.00, isCustomizable: false }, 
                { id: 'hamb-2', nome: 'X-Tudo Cl√°ssico', desc: 'O favorito da galera! Carne, ovo, queijo, presunto, bacon, calabresa, salada e nosso molho especial.', preco: 14.00, isCustomizable: false }, 
                { id: 'hamb-3', nome: 'X-Burguer Tropicaliente', desc: 'Uma explos√£o de sabor! Carne, queijo, presunto, bacon, calabresa, molho e batata palha crocante.', preco: 12.00, isCustomizable: false }, 
                { id: 'hamb-4', nome: 'X-Egg Perfeito', desc: 'A combina√ß√£o que nunca erra: carne suculenta, queijo derretido e um ovo no ponto certo.', preco: 10.00, isCustomizable: false }, 
                { id: 'hamb-5', nome: 'X-Burguer Kids', desc: 'O tamanho ideal para a fome da crian√ßada: p√£o, carne, queijo, nosso molho especial e batata palha.', preco: 5.00, isCustomizable: false }, 
                { id: 'hamb-6', nome: 'X-Burguer Double Cheese', desc: 'Para os amantes de queijo! Carne, presunto e uma dose dupla de catupiry e cheddar cremoso.', preco: 11.00, isCustomizable: false }, 
                { id: 'hamb-7', nome: 'X-Bacon Lover', desc: 'Chamado para os bacon lovers! P√£o, carne, queijo e o dobro de bacon extra crocante.', preco: 11.00, isCustomizable: false } 
            ],

            esfihas: {
                saboresComPreco: [ { id: 'esfiha-1', nome: 'Carne ü•©', preco: 3.50, precoAdicional: 0, isCustomizable: false }, { id: 'esfiha-2', nome: 'Queijo üßÄ', preco: 3.50, precoAdicional: 0, isCustomizable: false }, { id: 'esfiha-3', nome: 'Calabresa', preco: 3.50, precoAdicional: 0, isCustomizable: false }, { id: 'esfiha-4', nome: 'Presunto', preco: 3.50, precoAdicional: 0.50, isCustomizable: false }, { id: 'esfiha-5', nome: 'Milho üåΩ', preco: 3.50, precoAdicional: 0.50, isCustomizable: false }, { id: 'esfiha-6', nome: 'Atum', preco: 4.00, precoAdicional: 1.00, isCustomizable: false }, { id: 'esfiha-7', nome: 'Mista', preco: 4.00, precoAdicional: 1.00, isCustomizable: false }, { id: 'esfiha-8', nome: 'Frango c/ Catupiry', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-9', nome: 'Calabresa c/ Catupiry', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-10', nome: '4 Queijos üßÄ', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-11', nome: 'Tomate Seco üçÖ', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-12', nome: 'Portuguesa', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-13', nome: 'Carne Seca', preco: 5.00, precoAdicional: 2.00, isCustomizable: false }, { id: 'esfiha-14', nome: 'Bacalhau c/ Catupiry', preco: 5.00, precoAdicional: 2.00, isCustomizable: false }, { id: 'esfiha-15', nome: 'Romeu & Julieta ‚ù§Ô∏è', preco: 3.50, precoAdicional: 0.50, isCustomizable: false }, { id: 'esfiha-16', nome: 'Banana c/ Canela üçå', preco: 3.50, precoAdicional: 0.50, isCustomizable: false }, { id: 'esfiha-17', nome: 'Choco Duo üç´', preco: 4.00, precoAdicional: 1.00, isCustomizable: false }, { id: 'esfiha-18', nome: 'Prest√≠gio ü••üç´', preco: 4.00, precoAdicional: 1.00, isCustomizable: false }, { id: 'esfiha-19', nome: 'Morango c/ Choco üçì', preco: 4.50, precoAdicional: 1.50, isCustomizable: false }, { id: 'esfiha-20', nome: 'Nutella üòç', preco: 5.00, precoAdicional: 2.00, isCustomizable: false } ],
                combos: [ { id: 'esfiha-combo-20', nome: 'Super Combo 20 Esfihas + Refri', desc: 'Monte seu combo com 20 esfihas e escolha seu refrigerante de 2L para acompanhar!', preco: 50.00, quantidade: 20, includesSoda: true, isCustomizable: true }, { id: 'esfiha-combo-15', nome: 'Combo 15 Esfihas', desc: 'Fome na medida certa? Escolha 15 esfihas deliciosas do seu jeito!', preco: 40.00, quantidade: 15, isCustomizable: true }, { id: 'esfiha-combo-30', nome: 'Mega Combo 30 Esfihas', desc: 'Para dividir com todo mundo! Monte seu combo com 30 esfihas variadas.', preco: 70.00, quantidade: 30, isCustomizable: true } ]
            },
            
            combos: [ 
                { id: 'combo-1', nome: 'Combo Super Fam√≠lia', desc: 'Um banquete! 4 X-Tudo, 25 salgados, batata turbinada com cheddar e bacon.', preco: 85.00, isCustomizable: true, includesSoda: true}, 
                { id: 'combo-2', nome: 'Cento de Salgadinhos', desc: 'A festa est√° garantida com 100 salgadinhos fritos, grandes e sortidos. Imposs√≠vel comer um s√≥!', preco: 70.00, isCustomizable: false }, 
                { id: 'combo-3', nome: 'Combo Petisco Campe√£o', desc: 'Perfeito para relaxar: 25 salgados, por√ß√£o de calabresa e batata com cheddar cremoso.', preco: 85.00, isCustomizable: true, includesSoda: true}, 
                { id: 'combo-4', nome: 'Combo dos Amigos', desc: 'Re√∫na a galera! 4 X-Tudo, 25 salgados, calabresa acebolada e an√©is de cebola crocantes.', preco: 85.00, isCustomizable: true, includesSoda: true}, 
                { id: 'combo-5', nome: 'Combo Maratona de S√©ries', desc: 'O parceiro ideal para suas noites de sof√°: 4 X-Tudo, 25 salgados e uma generosa por√ß√£o de batata com cheddar e bacon.', preco: 85.00, isCustomizable: true, includesSoda: true}, 
                { id: 'combo-6', nome: 'Combo Tira-Gosto Total', desc: 'Uma sele√ß√£o de dar √°gua na boca: 4 X-Tudo, calabresa acebolada, batata frita e an√©is de cebola.', preco: 85.00, isCustomizable: true, includesSoda: true}, 
                { id: 'combo-7', nome: 'Frango a Passarinho com Fritas', desc: 'Suculentos peda√ßos de frango crocante acompanhados de batatas fritas sequinhas. J√° inclui um refri!', preco: 60.00, isCustomizable: true, includesSoda: true} 
            ],
            
            bebidas: [ { id: 'bebida-1', nome: 'Refrigerante em Lata 350ml', desc: 'Geladinho para matar a sua sede. Escolha o seu sabor preferido!', preco: 5.00, isCustomizable: false }, { id: 'bebida-2', nome: 'Refrigerante 2 Litros', desc: 'Para compartilhar com a galera e deixar qualquer refei√ß√£o ainda melhor.', preco: 12.00, isCustomizable: false } ]
        };

        let cart = [];
        let appliedCoupon = null;

        function formatCurrency(value) { return value.toFixed(2).replace('.', ','); }
        
        function findItem(category, itemId) {
            if (category === 'esfihas-individuais') return data.esfihas.saboresComPreco.find(i => i.id === itemId);
            if (category === 'esfihas-combos') return data.esfihas.combos.find(i => i.id === itemId);
            return data[category]?.find(i => i.id === itemId) || null;
        }

        function updateCart() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartSubtotalEl = document.getElementById('cartSubtotal');
            const cartTotalEl = document.getElementById('cartTotal');
            const floatingCartButton = document.getElementById('floatingCartButton');
            const floatingCartTotal = document.getElementById('floatingCartTotal');
            const checkoutButton = document.getElementById('checkoutButton');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-gray-500 text-center">Seu carrinho est√° vazio.</p>';
                floatingCartButton.classList.add('hidden');
                checkoutButton.disabled = true;
            } else {
                cartItemsContainer.innerHTML = cart.map((item, index) => `
                    <div class="flex justify-between items-start mb-3 p-2 rounded-md bg-gray-50 cart-item-enter">
                        <div class="flex-grow">
                            <p class="font-bold text-gray-800">${item.nome}</p>
                            <p class="text-xs text-gray-500">${item.desc || ''}</p>
                            <p class="text-sm font-semibold text-red-600">R$ ${formatCurrency(item.preco)}</p>
                        </div>
                        <button class="remove-from-cart-btn text-red-500 hover:text-red-700 ml-4" data-index="${index}">&times;</button>
                    </div>
                `).join('');
                floatingCartButton.classList.remove('hidden');
                checkoutButton.disabled = false;
            }

            const subtotal = cart.reduce((acc, item) => acc + item.preco, 0);
            cartSubtotalEl.textContent = `R$ ${formatCurrency(subtotal)}`;
            cartTotalEl.textContent = `R$ ${formatCurrency(subtotal)}`;
            floatingCartTotal.textContent = `R$ ${formatCurrency(subtotal)}`;

            document.querySelectorAll('.remove-from-cart-btn').forEach(button => {
                button.addEventListener('click', (e) => removeFromCart(parseInt(e.currentTarget.dataset.index)));
            });
        }

        function addToCart(product) {
            cart.push(product);
            updateCart();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
        }

        function createMenuSection(title, items, containerId, category) {
            const container = document.getElementById(containerId);
            if (!container) return;

            let content = `<h2 class="text-2xl font-bold text-center text-red-800 mb-6">${title}</h2>`;
            content += '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">';
            
            items.forEach(item => {
                const priceDisplay = typeof item.preco === 'number'
                    ? `<div>
                           ${item.preco_antigo ? `<span class="text-sm text-gray-500 line-through">R$ ${formatCurrency(item.preco_antigo)}</span>` : ''}
                           <span class="font-bold text-xl text-red-700">R$ ${formatCurrency(item.preco)}</span>
                       </div>`
                    : '<div></div>';

                const buttonText = item.isCustomizable ? 'Personalizar' : 'Adicionar';

                content += `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                        <div class="p-4 flex-grow">
                            <h3 class="font-bold text-lg text-gray-800">${item.nome}</h3>
                            <p class="text-sm text-gray-600 mt-1">${item.desc}</p>
                        </div>
                        <div class="p-4 bg-gray-50">
                            <div class="flex justify-between items-center">
                                ${priceDisplay}
                                <button class="add-item-btn bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700" 
                                    data-id="${item.id}"
                                    data-category="${category}"
                                    data-name="${item.nome}"
                                    data-price="${item.preco}"
                                    data-customizable="${item.isCustomizable}">
                                    ${buttonText}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            content += '</div>';
            container.innerHTML = content;
        }

        function createEsfihasSection() {
            const container = document.getElementById('esfihas');
            if (!container) return;
            let content = '';

            content += `<h2 class="text-2xl font-bold text-center text-red-800 mb-6">Combos de Esfiha ü•ü</h2>`;
            content += '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">';
            data.esfihas.combos.forEach(item => {
                content += `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                        <div class="p-4 flex-grow">
                            <h3 class="font-bold text-lg text-gray-800">${item.nome}</h3>
                            <p class="text-sm text-gray-600 mt-1">${item.desc}</p>
                        </div>
                        <div class="p-4 bg-gray-50">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-xl text-red-700">R$ ${formatCurrency(item.preco)}</span>
                                <button class="add-item-btn bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700"
                                    data-id="${item.id}"
                                    data-category="esfihas-combos"
                                    data-name="${item.nome}"
                                    data-price="${item.preco}"
                                    data-customizable="${item.isCustomizable}">
                                    Montar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            content += '</div>';

            content += `<h2 class="text-2xl font-bold text-center text-red-800 mb-6">Esfihas Individuais</h2>`;
            content += '<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">';
            data.esfihas.saboresComPreco.forEach(item => {
                content += `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden flex flex-col">
                        <div class="p-3 flex-grow">
                            <h3 class="font-semibold text-md text-gray-800">${item.nome}</h3>
                        </div>
                        <div class="p-3 bg-gray-50">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-lg text-red-700">R$ ${formatCurrency(item.preco)}</span>
                                <button class="add-item-btn bg-red-600 text-white font-bold py-1 px-3 rounded-lg hover:bg-red-700 text-sm"
                                    data-id="${item.id}"
                                    data-category="esfihas-individuais"
                                    data-name="${item.nome}"
                                    data-price="${item.preco}"
                                    data-customizable="false">
                                    +
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            content += '</div>';
            container.innerHTML = content;
        }

        function initPizzaBuilder() {
            const pizzaSection = document.getElementById('pizzas');
            if(!pizzaSection || pizzaSection.innerHTML.includes('buildPizzaForm')) return;
            pizzaSection.innerHTML = `<h2 class="text-2xl font-bold text-center text-red-800 mb-6">Monte sua Pizza üçï</h2><div class="bg-white p-6 rounded-xl shadow-lg max-w-4xl mx-auto"><form id="buildPizzaForm" class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><div class="mb-4"><label for="pizzaSizeSelect" class="block text-gray-700 text-sm font-bold mb-2">1. Escolha o Tamanho:</label><select id="pizzaSizeSelect" class="shadow border rounded w-full py-2 px-3 text-gray-700"></select></div><div class="mb-6"><label for="pizzaBordaSelect" class="block text-gray-700 text-sm font-bold mb-2">2. Borda Recheada (Opcional):</label><select id="pizzaBordaSelect" class="shadow border rounded w-full py-2 px-3 text-gray-700"></select></div><div id="pizzaSodaContainer" class="mb-6"></div><div><label class="block text-gray-700 text-sm font-bold mb-2">3. Escolha os Sabores:</label><p id="pizzaFlavorWarning" class="text-xs text-red-600 mb-2 hidden"></p><div id="flavorsAccordion" class="space-y-2 max-h-72 overflow-y-auto custom-scroll pr-2"></div></div></div><div class="bg-amber-50 p-4 rounded-lg border-2 border-amber-200 flex flex-col justify-between"><div><h3 class="font-bold text-lg text-red-800 border-b pb-2 mb-3">Resumo do Pedido</h3><div class="space-y-2 text-sm"><p><strong>Tamanho:</strong> <span id="summarySize"></span></p><p><strong>Borda:</strong> <span id="summaryBorda"></span></p><p><strong>Refrigerante(s):</strong> <span id="summarySoda">Nenhum</span></p><div><strong class="block">Sabores:</strong><ul id="summaryFlavors" class="list-disc list-inside ml-2 text-gray-600"><li>Nenhum selecionado</li></ul></div></div></div><div class="mt-6 text-center"><p class="text-gray-600 text-lg">Total do Item:</p><p class="font-extrabold text-4xl text-red-700 my-2">R$ <span id="pizzaTotal">0,00</span></p><button type="submit" id="addPizzaToCartBtn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg text-lg mt-4" disabled>Adicionar ao Carrinho</button></div></div></form></div>`;
            const uiPizza = {
                form: document.getElementById('buildPizzaForm'), sizeSelect: document.getElementById('pizzaSizeSelect'), bordaSelect: document.getElementById('pizzaBordaSelect'), sodaContainer: document.getElementById('pizzaSodaContainer'), flavorsAccordion: document.getElementById('flavorsAccordion'), warning: document.getElementById('pizzaFlavorWarning'), summarySize: document.getElementById('summarySize'), summaryBorda: document.getElementById('summaryBorda'), summarySoda: document.getElementById('summarySoda'), summaryFlavors: document.getElementById('summaryFlavors'), total: document.getElementById('pizzaTotal'), addBtn: document.getElementById('addPizzaToCartBtn'),
            };
            function populate() {
                uiPizza.sizeSelect.innerHTML = data.pizzas.tamanhos.map((t, i) => `<option value="${i}">${t.nome}</option>`).join('');
                const allFlavors = { "Sabores Salgados üçï": data.pizzas.saboresSalgados, "Sabores Doces üç∞": data.pizzas.saboresDoces };
                uiPizza.flavorsAccordion.innerHTML = Object.entries(allFlavors).map(([category, flavors]) => `<div><button type="button" class="w-full flex justify-between items-center p-3 font-semibold text-left bg-gray-100 rounded-lg hover:bg-gray-200 accordion-toggle"><span>${category}</span><i class="fas fa-chevron-down transform transition-transform"></i></button><div class="hidden pt-2 pb-4 px-2 space-y-2 grid grid-cols-2 gap-3 custom-scroll rounded bg-gray-50 shadow-inner">${flavors.sort().map(flavor => `<label class="flex items-center p-2 rounded-md hover:bg-yellow-100"><input type="checkbox" class="flavor-checkbox h-4 w-4 rounded border-gray-300 text-red-600" value="${flavor}"><span class="ml-2 text-gray-700 text-sm">${flavor}</span></label>`).join('')}</div></div>`).join('');
                updateOptions();
            }
            function updateOptions() {
                const selectedSize = data.pizzas.tamanhos[uiPizza.sizeSelect.value];
                uiPizza.bordaSelect.innerHTML = data.pizzas.bordas.map((borda, i) => {
                    let price = borda.precoPadrao;
                    if (selectedSize.nome.includes('Mega')) price = borda.precoMega ?? borda.precoPadrao;
                    else if (selectedSize.nome.includes('M√©dia')) price = borda.precoMedia ?? borda.precoPadrao;
                    else if (selectedSize.nome.includes('Individual')) price = borda.precoIndividual ?? borda.precoPadrao;
                    return `<option value="${i}">${borda.nome} ${price > 0 ? `(+ R$ ${formatCurrency(price)})` : ''}</option>`;
                }).join('');
                renderPizzaSodaOptions();
                updatePrice();
            }
            function renderPizzaSodaOptions() {
                const selectedSize = data.pizzas.tamanhos[uiPizza.sizeSelect.value];
                uiPizza.sodaContainer.innerHTML = '';
                if(selectedSize.sodasInclusas > 0) {
                    let sodaHtml = '';
                    for (let i = 1; i <= selectedSize.sodasInclusas; i++) {
                        sodaHtml += `<div class="mb-4"><label class="block text-gray-700 text-sm font-bold mb-2">Escolha seu ${i}¬∫ Refrigerante:</label><select name="pizza-soda" class="pizza-soda-select shadow border rounded w-full py-2 px-3 text-gray-700">${data.refrigerantesPromo.map(refri => `<option value="${refri.nome}" data-price="${refri.precoAdicional}">${refri.nome} ${refri.precoAdicional > 0 ? `(+ R$ ${formatCurrency(refri.precoAdicional)})` : ''}</option>`).join('')}</select></div>`;
                    }
                    uiPizza.sodaContainer.innerHTML = sodaHtml;
                }
            }
            function updatePrice() {
                const selectedSize = data.pizzas.tamanhos[uiPizza.sizeSelect.value];
                const selectedBorda = data.pizzas.bordas[uiPizza.bordaSelect.value];
                uiPizza.summarySize.textContent = selectedSize.nome;
                uiPizza.summaryBorda.textContent = selectedBorda.nome;
                
                const selectedFlavors = Array.from(uiPizza.flavorsAccordion.querySelectorAll('.flavor-checkbox:checked'));
                if (selectedFlavors.length > selectedSize.maxSabores) {
                    uiPizza.warning.textContent = `M√°ximo de ${selectedSize.maxSabores} sabores!`;
                    uiPizza.warning.classList.remove('hidden');
                    selectedFlavors[selectedFlavors.length - 1].checked = false;
                } else {
                    uiPizza.warning.classList.add('hidden');
                }
                const currentFlavors = Array.from(uiPizza.flavorsAccordion.querySelectorAll('.flavor-checkbox:checked')).map(cb => cb.value);
                uiPizza.summaryFlavors.innerHTML = currentFlavors.length > 0 ? currentFlavors.map(f => `<li>${f}</li>`).join('') : `<li>Nenhum selecionado</li>`;
                uiPizza.addBtn.disabled = currentFlavors.length === 0;

                let total = selectedSize.preco;
                let bordaPrice = selectedBorda.precoPadrao;
                if (selectedSize.nome.includes('Mega')) bordaPrice = selectedBorda.precoMega ?? bordaPrice;
                else if (selectedSize.nome.includes('M√©dia')) bordaPrice = selectedBorda.precoMedia ?? bordaPrice;
                else if (selectedSize.nome.includes('Individual')) bordaPrice = selectedBorda.precoIndividual ?? bordaPrice;
                total += bordaPrice;

                const selectedSodas = [];
                uiPizza.sodaContainer.querySelectorAll('.pizza-soda-select').forEach(select => {
                    const selectedOption = select.options[select.selectedIndex];
                    total += parseFloat(selectedOption.dataset.price);
                    selectedSodas.push(selectedOption.value);
                });
                uiPizza.summarySoda.textContent = selectedSodas.length > 0 ? selectedSodas.join(', ') : 'Nenhum';

                uiPizza.total.textContent = formatCurrency(total);
            }
            uiPizza.form.addEventListener('submit', e => {
                e.preventDefault();
                const selectedSize = data.pizzas.tamanhos[uiPizza.sizeSelect.value];
                const selectedBorda = data.pizzas.bordas[uiPizza.bordaSelect.value];
                const selectedFlavors = Array.from(uiPizza.flavorsAccordion.querySelectorAll('.flavor-checkbox:checked')).map(cb => cb.value);
                if (selectedFlavors.length === 0) { alert('Por favor, escolha pelo menos um sabor para a pizza!'); return; }
                
                const selectedSodas = Array.from(uiPizza.sodaContainer.querySelectorAll('.pizza-soda-select')).map(s => s.value);
                
                const total = parseFloat(uiPizza.total.textContent.replace(',', '.'));
                let desc = `Borda: ${selectedBorda.nome}`;
                if(selectedSodas.length > 0) {
                    desc += ` | Bebida(s): ${selectedSodas.join(', ')}`;
                }
                const pizzaProduct = { nome: `Pizza ${selectedSize.nome.split(' ')[0]} (${selectedFlavors.join(', ')})`, desc: desc, preco: total };
                addToCart(pizzaProduct);
                alert('Pizza adicionada ao carrinho!');
                uiPizza.flavorsAccordion.querySelectorAll('.flavor-checkbox').forEach(cb => cb.checked = false);
                updatePrice();
            });
            uiPizza.sizeSelect.addEventListener('change', updateOptions);
            uiPizza.bordaSelect.addEventListener('change', updatePrice);
            uiPizza.flavorsAccordion.addEventListener('change', updatePrice);
            uiPizza.sodaContainer.addEventListener('change', updatePrice);
            
            uiPizza.flavorsAccordion.addEventListener('click', (e) => {
                const toggle = e.target.closest('.accordion-toggle');
                if (toggle) {
                    toggle.classList.toggle('open');
                    const content = toggle.nextElementSibling;
                    content.classList.toggle('hidden');
                }
            });
            populate();
        }

        function openMassaModal(item) {
            const modal = document.getElementById('massaModal');
            const title = document.getElementById('massaModalTitle');
            const container = document.getElementById('massaSelectionContainer');
            const totalEl = document.getElementById('massaTotal');
            const form = document.getElementById('massaForm');
            const cancelBtn = document.getElementById('cancelMassa');

            title.textContent = `Personalizar ${item.nome}`;
            
            let html = `
                <div>
                    <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">1. Escolha o Tamanho</h3>
                    <div class="space-y-2">${data.massaSizes.map((size, index) => `
                        <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                            <input type="radio" name="massa-size" value="${index}" class="h-4 w-4 text-red-600" ${index === 0 ? 'checked' : ''}>
                            <span class="ml-2 text-gray-700">${size.nome} (R$ ${formatCurrency(size.preco)})</span>
                        </label>`).join('')}
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">2. Escolha a Prote√≠na</h3>
                    <div class="space-y-2">${data.proteinasMassas.map((prot, index) => `
                        <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                            <input type="radio" name="massa-proteina" value="${index}" class="h-4 w-4 text-red-600" ${index === 0 ? 'checked' : ''}>
                            <span class="ml-2 text-gray-700">${prot.nome} ${prot.precoAdicional > 0 ? `(+ R$ ${formatCurrency(prot.precoAdicional)})` : ''}</span>
                        </label>`).join('')}
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">3. Escolha o Molho</h3>
                    <div class="space-y-2">${data.molhosMassas.map((molho, index) => `
                        <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                            <input type="radio" name="massa-molho" value="${molho.nome}" class="h-4 w-4 text-red-600" ${index === 0 ? 'checked' : ''}>
                            <span class="ml-2 text-gray-700">${molho.nome}</span>
                        </label>`).join('')}
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">4. Ingredientes Adicionais (Opcional)</h3>
                    <div class="grid grid-cols-2 gap-2">${data.ingredientesMassas.map((ing, index) => `
                        <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                            <input type="checkbox" name="massa-ingrediente" value="${index}" class="h-4 w-4 rounded border-gray-300 text-red-600">
                            <span class="ml-2 text-sm text-gray-700">${ing.nome} (+ R$ ${formatCurrency(ing.precoAdicional)})</span>
                        </label>`).join('')}
                    </div>
                </div>
            `;
            container.innerHTML = html;

            const updateMassaTotal = () => {
                let total = 0;
                const sizeIndex = form.querySelector('input[name="massa-size"]:checked').value;
                const selectedSize = data.massaSizes[sizeIndex];
                total += selectedSize.preco;

                const proteinaIndex = form.querySelector('input[name="massa-proteina"]:checked').value;
                total += data.proteinasMassas[proteinaIndex].precoAdicional;

                const ingredientes = form.querySelectorAll('input[name="massa-ingrediente"]:checked');
                ingredientes.forEach(ing => {
                    total += data.ingredientesMassas[ing.value].precoAdicional;
                });
                
                totalEl.textContent = formatCurrency(total);
            };

            const formSubmitHandler = (e) => {
                e.preventDefault();
                const size = data.massaSizes[form.querySelector('input[name="massa-size"]:checked').value];
                const proteina = data.proteinasMassas[form.querySelector('input[name="massa-proteina"]:checked').value];
                const molho = form.querySelector('input[name="massa-molho"]:checked').value;
                const ingredientes = Array.from(form.querySelectorAll('input[name="massa-ingrediente"]:checked')).map(cb => data.ingredientesMassas[cb.value].nome);

                const nomeFinal = `${item.nome} (${proteina.nome})`;
                let descFinal = `Tamanho: ${size.nome.split(' ')[0]}, Molho: ${molho}`;
                if (ingredientes.length > 0) {
                    descFinal += ` | Adicionais: ${ingredientes.join(', ')}`;
                }

                addToCart({
                    nome: nomeFinal,
                    desc: descFinal,
                    preco: parseFloat(totalEl.textContent.replace(',', '.'))
                });
                closeModal();
            };
            
            const closeModal = () => {
                modal.classList.add('hidden');
                form.removeEventListener('change', updateMassaTotal);
                form.removeEventListener('submit', formSubmitHandler);
                container.innerHTML = '';
            };

            form.addEventListener('change', updateMassaTotal);
            form.addEventListener('submit', formSubmitHandler);
            cancelBtn.onclick = closeModal;
            
            updateMassaTotal();
            modal.classList.remove('hidden');
        }

        function openEsfihaComboModal(item) {
            const modal = document.getElementById('esfihaComboModal');
            const title = document.getElementById('esfihaComboModalTitle');
            const selectionContainer = document.getElementById('esfihaComboSelectionContainer');
            const sodaContainer = document.getElementById('esfihaComboSodaContainer');
            const counter = document.getElementById('esfihaCounter');
            const totalQty = document.getElementById('esfihaTotalQty');
            const warning = document.getElementById('esfihaWarning');
            const totalEl = document.getElementById('esfihaComboTotal');
            const addBtn = document.getElementById('addEsfihaComboBtn');
            const form = document.getElementById('esfihaComboForm');
            const cancelBtn = document.getElementById('cancelEsfihaCombo');
            
            let currentSelections = {};

            title.textContent = `Monte seu ${item.nome}`;
            totalQty.textContent = item.quantidade;

            selectionContainer.innerHTML = data.esfihas.saboresComPreco.map(sabor => `
                <div class="flex justify-between items-center p-2 border-b">
                    <div>
                        <p class="font-semibold text-gray-800">${sabor.nome}</p>
                        <p class="text-xs text-gray-500">${sabor.precoAdicional > 0 ? `+ R$ ${formatCurrency(sabor.precoAdicional)}` : 'Pre√ßo base'}</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <button type="button" class="esfiha-ctrl-btn bg-gray-200 rounded-full w-6 h-6 font-bold text-lg" data-id="${sabor.id}" data-op="-">-</button>
                        <span id="qty-${sabor.id}" class="font-bold w-4 text-center">0</span>
                        <button type="button" class="esfiha-ctrl-btn bg-gray-200 rounded-full w-6 h-6 font-bold text-lg" data-id="${sabor.id}" data-op="+">+</button>
                    </div>
                </div>
            `).join('');
            
            sodaContainer.innerHTML = '';
            if (item.includesSoda) {
                sodaContainer.innerHTML = `
                    <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">Escolha seu Refrigerante</h3>
                    <select name="combo-soda" class="w-full p-2 border rounded-md">
                        ${data.refrigerantesPromo.map(refri => `<option value="${refri.nome}" data-price="${refri.precoAdicional}">${refri.nome} ${refri.precoAdicional > 0 ? `(+ R$ ${formatCurrency(refri.precoAdicional)})` : ''}</option>`).join('')}
                    </select>
                `;
            }

            const updateEsfihaComboTotal = () => {
                let currentTotal = item.preco;
                let count = 0;
                
                for(const id in currentSelections) {
                    const qty = currentSelections[id];
                    count += qty;
                    const saborInfo = data.esfihas.saboresComPreco.find(s => s.id === id);
                    if(saborInfo) {
                        currentTotal += saborInfo.precoAdicional * qty;
                    }
                }
                
                if (item.includesSoda) {
                    const sodaSelect = sodaContainer.querySelector('select');
                    currentTotal += parseFloat(sodaSelect.options[sodaSelect.selectedIndex].dataset.price);
                }

                counter.textContent = count;
                totalEl.textContent = formatCurrency(currentTotal);
                
                if (count > item.quantidade) {
                    warning.textContent = `Voc√™ selecionou ${count} esfihas, o limite √© ${item.quantidade}!`;
                    warning.classList.remove('hidden');
                    addBtn.disabled = true;
                } else if (count < item.quantidade) {
                     warning.textContent = `Faltam ${item.quantidade - count} esfihas.`;
                     warning.classList.remove('hidden');
                     addBtn.disabled = true;
                } else {
                    warning.classList.add('hidden');
                    addBtn.disabled = false;
                }
            };
            
            const esfihaClickHandler = (e) => {
                const btn = e.target.closest('.esfiha-ctrl-btn');
                if (!btn) return;
                
                const id = btn.dataset.id;
                const op = btn.dataset.op;
                
                currentSelections[id] = currentSelections[id] || 0;
                
                let count = Object.values(currentSelections).reduce((a, b) => a + b, 0);

                if (op === '+') {
                    if (count < item.quantidade) {
                        currentSelections[id]++;
                    }
                } else if (op === '-') {
                    if (currentSelections[id] > 0) {
                        currentSelections[id]--;
                    }
                }
                document.getElementById(`qty-${id}`).textContent = currentSelections[id];
                updateEsfihaComboTotal();
            };

            selectionContainer.addEventListener('click', esfihaClickHandler);

            if (item.includesSoda) {
                sodaContainer.querySelector('select').addEventListener('change', updateEsfihaComboTotal);
            }

            const formSubmitHandler = (e) => {
                e.preventDefault();
                const esfihasSelecionadas = [];
                for(const id in currentSelections) {
                    if (currentSelections[id] > 0) {
                        const sabor = data.esfihas.saboresComPreco.find(s => s.id === id);
                        esfihasSelecionadas.push(`${currentSelections[id]}x ${sabor.nome.split(' ')[0]}`);
                    }
                }
                
                let descFinal = esfihasSelecionadas.join(', ');
                if (item.includesSoda) {
                    descFinal += ` | Bebida: ${sodaContainer.querySelector('select').value}`;
                }

                addToCart({
                    nome: item.nome,
                    desc: descFinal,
                    preco: parseFloat(totalEl.textContent.replace(',', '.'))
                });
                closeModal();
            };

            const closeModal = () => {
                modal.classList.add('hidden');
                form.removeEventListener('submit', formSubmitHandler);
                selectionContainer.removeEventListener('click', esfihaClickHandler);
                selectionContainer.innerHTML = '';
                sodaContainer.innerHTML = '';
            };

            form.addEventListener('submit', formSubmitHandler);
            cancelBtn.onclick = closeModal;

            updateEsfihaComboTotal();
            modal.classList.remove('hidden');
        }
        
        function openComboSodaModal(item) {
            const modal = document.getElementById('promoModal');
            const title = document.getElementById('promoModalTitle');
            const container = document.getElementById('promoSelectionContainer');
            const totalEl = document.getElementById('promoTotal');
            const form = document.getElementById('promoForm');
            const cancelBtn = document.getElementById('cancelPromo');
            const addBtn = document.getElementById('addPromoBtn');

            title.textContent = `Escolha a bebida para: ${item.nome}`;
            
            container.innerHTML = `
                <div class="p-2">
                    <label for="combo-soda-select" class="block font-bold text-gray-700 mb-2">Refrigerante Incluso:</label>
                    <select id="combo-soda-select" class="w-full p-2 border border-gray-300 rounded-md">
                        ${data.refrigerantesPromo.map(refri => `
                            <option value="${refri.nome}" data-price="${refri.precoAdicional}">
                                ${refri.nome} ${refri.precoAdicional > 0 ? `(+ R$ ${formatCurrency(refri.precoAdicional)})` : '(Gr√°tis)'}
                            </option>
                        `).join('')}
                    </select>
                </div>
            `;

            const updateTotal = () => {
                let total = item.preco;
                const sodaSelect = document.getElementById('combo-soda-select');
                if (sodaSelect) {
                    const selectedOption = sodaSelect.options[sodaSelect.selectedIndex];
                    total += parseFloat(selectedOption.dataset.price);
                }
                totalEl.textContent = formatCurrency(total);
                addBtn.disabled = false; // Habilita o bot√£o, pois a √∫nica escolha j√° foi feita
            };

            const submitHandler = (e) => {
                e.preventDefault();
                const sodaSelect = document.getElementById('combo-soda-select');
                const selectedSoda = sodaSelect.value;
                const finalPrice = parseFloat(totalEl.textContent.replace(',', '.'));

                addToCart({
                    nome: item.nome,
                    desc: `${item.desc} | Bebida: ${selectedSoda}`,
                    preco: finalPrice
                });
                closeModal();
            };
            
            const closeModal = () => {
                modal.classList.add('hidden');
                form.removeEventListener('submit', submitHandler);
                container.innerHTML = '';
            };

            form.addEventListener('submit', submitHandler);
            container.querySelector('select').addEventListener('change', updateTotal);
            cancelBtn.onclick = closeModal;
            
            updateTotal();
            modal.classList.remove('hidden');
        }

        function openPromoPizzaModal(item) {
            const modal = document.getElementById('promoModal');
            const titleEl = document.getElementById('promoModalTitle');
            const container = document.getElementById('promoSelectionContainer');
            const totalEl = document.getElementById('promoTotal');
            const form = document.getElementById('promoForm');
            const cancelBtn = document.getElementById('cancelPromo');
            const addBtn = document.getElementById('addPromoBtn');

            titleEl.textContent = `Monte sua Promo: ${item.nome}`;
            
            let html = '';
            // Render Pizza Selectors
            item.pizzas.forEach((pizzaInfo, index) => {
                html += `
                    <div>
                        <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">Escolha os Sabores (Pizza ${pizzaInfo.size})</h3>
                        <p class="text-xs text-gray-500 mb-2">Voc√™ pode escolher at√© ${pizzaInfo.maxSabores} sabores.</p>
                        <div class="grid grid-cols-2 gap-2 max-h-40 overflow-y-auto custom-scroll p-2 bg-gray-50 rounded">
                            ${data.pizzas.saboresSalgados.map(sabor => `
                                <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                                    <input type="checkbox" name="promo-pizza-${index}" value="${sabor}" class="h-4 w-4 rounded border-gray-300 text-red-600">
                                    <span class="ml-2 text-sm text-gray-700">${sabor}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            // Render Sweet Pizza Selector
            if (item.includesSweet) {
                 html += `
                    <div>
                        <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">Escolha sua Pizza Doce (Individual)</h3>
                         <div class="space-y-2">
                            ${data.pizzas.saboresDoces.map((sabor, index) => `
                                <label class="flex items-center p-2 rounded-md hover:bg-yellow-100">
                                    <input type="radio" name="promo-pizza-doce" value="${sabor}" class="h-4 w-4 text-red-600" ${index === 0 ? 'checked' : ''}>
                                    <span class="ml-2 text-gray-700">${sabor}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Render Soda Selector
            if (item.includesSoda) {
                html += `
                    <div>
                        <h3 class="font-bold text-md text-gray-700 mb-2 border-b pb-2">Escolha seu Refrigerante</h3>
                        <select name="promo-soda" class="w-full p-2 border rounded-md">
                            ${data.refrigerantesPromo.map(refri => `<option value="${refri.nome}" data-price="${refri.precoAdicional}">${refri.nome} ${refri.precoAdicional > 0 ? `(+ R$ ${formatCurrency(refri.precoAdicional)})` : ''}</option>`).join('')}
                        </select>
                    </div>
                `;
            }
            container.innerHTML = html;

            const updateTotal = () => {
                let total = item.preco;
                if (item.includesSoda) {
                    const sodaSelect = form.querySelector('[name="promo-soda"]');
                    total += parseFloat(sodaSelect.options[sodaSelect.selectedIndex].dataset.price);
                }
                totalEl.textContent = formatCurrency(total);
            };

            const validateSelections = () => {
                let isValid = true;
                item.pizzas.forEach((pizzaInfo, index) => {
                    const checked = container.querySelectorAll(`input[name="promo-pizza-${index}"]:checked`);
                    if (checked.length === 0 || checked.length > pizzaInfo.maxSabores) {
                        isValid = false;
                    }
                });
                addBtn.disabled = !isValid;
            };

            const submitHandler = (e) => {
                e.preventDefault();
                let descParts = [];
                
                item.pizzas.forEach((pizzaInfo, index) => {
                    const sabores = Array.from(container.querySelectorAll(`input[name="promo-pizza-${index}"]:checked`)).map(cb => cb.value);
                    descParts.push(`Pizza ${pizzaInfo.size}: ${sabores.join(', ')}`);
                });

                if (item.includesSweet) {
                    descParts.push(`Doce: ${form.querySelector('[name="promo-pizza-doce"]:checked').value}`);
                }
                if (item.includesSoda) {
                    descParts.push(`Bebida: ${form.querySelector('[name="promo-soda"]').value}`);
                }

                addToCart({
                    nome: item.nome,
                    desc: descParts.join(' | '),
                    preco: parseFloat(totalEl.textContent.replace(',', '.'))
                });
                closeModal();
            };

            const closeModal = () => {
                modal.classList.add('hidden');
                form.removeEventListener('submit', submitHandler);
                form.removeEventListener('change', formChangeHandler);
                container.innerHTML = '';
            };

            const formChangeHandler = () => {
                updateTotal();
                validateSelections();
            };
            
            form.addEventListener('submit', submitHandler);
            form.addEventListener('change', formChangeHandler);
            cancelBtn.onclick = closeModal;
            
            updateTotal();
            validateSelections();
            modal.classList.remove('hidden');
        }

        function initModals() {
            // L√≥gica de clique nos bot√µes de adicionar
            document.body.addEventListener('click', e => {
                const button = e.target.closest('.add-item-btn');
                if (!button) return;

                const isCustomizable = button.dataset.customizable === 'true';
                const category = button.dataset.category;
                const itemId = button.dataset.id;
                const item = findItem(category, itemId);

                if (!item) return console.error('Item n√£o encontrado:', category, itemId);

                if (isCustomizable) {
                    switch (category) {
                        case 'massas':
                            openMassaModal(item);
                            break;
                        case 'esfihas-combos':
                            openEsfihaComboModal(item);
                            break;
                        case 'combos':
                            if (item.includesSoda) openComboSodaModal(item);
                            else alert(`A personaliza√ß√£o para "${item.nome}" ainda n√£o foi implementada.`);
                            break;
                        case 'promocoes':
                            if (item.pizzas) openPromoPizzaModal(item);
                            else alert(`A personaliza√ß√£o para "${item.nome}" ainda n√£o foi implementada.`);
                            break;
                        default:
                            alert(`Item customiz√°vel sem a√ß√£o definida: ${category}`);
                    }
                } else {
                    addToCart({ nome: item.nome, preco: item.preco, desc: item.desc });
                    const originalText = button.innerHTML;
                    button.textContent = 'Adicionado!';
                    button.classList.add('bg-green-500', 'hover:bg-green-600');
                    button.classList.remove('bg-red-600', 'hover:bg-red-700');
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('bg-green-500', 'hover:bg-green-600');
                        button.classList.add('bg-red-600', 'hover:bg-red-700');
                    }, 1500);
                }
            });
            
            // L√≥gica dos Modais de Carrinho e Checkout
            const cartModal = document.getElementById('cartModal');
            const checkoutModal = document.getElementById('checkoutModal');
            const floatingCartButton = document.getElementById('floatingCartButton');
            const closeCartModal = document.getElementById('closeCartModal');
            const checkoutButton = document.getElementById('checkoutButton');
            const customerForm = document.getElementById('customerInfoForm');
            const cancelCheckoutBtn = document.getElementById('cancelButton');

            floatingCartButton.addEventListener('click', () => cartModal.classList.remove('hidden'));
            closeCartModal.addEventListener('click', () => cartModal.classList.add('hidden'));
            checkoutButton.addEventListener('click', () => {
                cartModal.classList.add('hidden');
                checkoutModal.classList.remove('hidden');
            });
            cancelCheckoutBtn.addEventListener('click', () => {
                checkoutModal.classList.add('hidden');
            });

            // L√≥gica de Envio para WhatsApp
            customerForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const customerName = document.getElementById('customerName').value;
                const customerAddress = document.getElementById('customerAddress').value;
                const customerNeighborhood = document.getElementById('customerNeighborhood').value;
                const customerObs = document.getElementById('customerObs').value;
                const paymentMethod = document.getElementById('paymentMethod').value;
                const ketchup = document.getElementById('ketchupQty').value;
                const mustard = document.getElementById('mustardQty').value;
                const total = document.getElementById('cartTotal').textContent;

                let pedidoText = `*-- NOVO PEDIDO --*\n\n`;
                pedidoText += `*Cliente:* ${customerName}\n`;
                pedidoText += `*Endere√ßo:* ${customerAddress}, ${customerNeighborhood}\n\n`;
                pedidoText += "*Itens do Pedido:*\n";
                cart.forEach(item => {
                    pedidoText += `- *${item.nome}*\n`;
                    if (item.desc) pedidoText += `  _${item.desc}_\n`;
                    pedidoText += `  *Pre√ßo:* R$ ${formatCurrency(item.preco)}\n\n`;
                });
                if (ketchup > 0 || mustard > 0) {
                    pedidoText += "*Sach√™s:*\n";
                    if (ketchup > 0) pedidoText += `- Ketchup: ${ketchup} un.\n`;
                    if (mustard > 0) pedidoText += `- Mostarda: ${mustard} un.\n`;
                }
                if (customerObs) pedidoText += `\n*Observa√ß√µes:* ${customerObs}\n`;
                pedidoText += `\n*Forma de Pagamento:* ${paymentMethod}\n`;
                pedidoText += `*TOTAL DO PEDIDO: ${total}*`;

                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(pedidoText)}`;
                window.open(whatsappUrl, '_blank');
            });
        }
        
        function initializeApp() {
            createMenuSection('Nossas Ofertas Imperd√≠veis! üî•', data.promocoes, 'promocoes', 'promocoes');
            createMenuSection('Nossas Massas Artesanais üçù', data.massas, 'massas', 'massas');
            createMenuSection('Nossos Hamb√∫rgueres Suculentos üçî', data.hamburgueres, 'hamburgueres', 'hamburgueres');
            createEsfihasSection();
            createMenuSection('Combos & Petiscos para Compartilhar üçü', data.combos, 'combos', 'combos');
            createMenuSection('Bebidas para Refrescar ü•§', data.bebidas, 'bebidas', 'bebidas');
            document.getElementById('contato').innerHTML = `<div class="text-center p-8 bg-white rounded-lg shadow-lg"><h2 class="text-3xl font-bold text-red-700 mb-4">Entre em Contato Conosco! üìû</h2><p class="text-gray-600 mb-2">Estamos prontos para atender voc√™.</p><div class="space-y-4 mt-6 text-lg"><p><i class="fab fa-whatsapp text-green-500 mr-2"></i><strong>WhatsApp:</strong> (21) 98141-7594</p><p><i class="fas fa-phone-alt text-blue-500 mr-2"></i><strong>Telefone:</strong> (21) 1234-5678</p><p><i class="fas fa-map-marker-alt text-red-500 mr-2"></i><strong>Endere√ßo:</strong> Rua da Pizza, 123 - Centro, Rio de Janeiro - RJ</p></div><div class="mt-8"><a href="https://wa.me/${WHATSAPP_NUMBER}" target="_blank" class="bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600 text-lg"><i class="fab fa-whatsapp"></i> Fazer Pedido via WhatsApp</a></div></div>`;

            initPizzaBuilder();
            initModals(); 

            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab-button').forEach(t => t.classList.remove('tab-active'));
                    tab.classList.add('tab-active');
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                    const tabContent = document.getElementById(tab.dataset.tab);
                    if (tabContent) {
                        tabContent.classList.remove('hidden');
                    }
                });
            });

            updateCart();
            console.log("Card√°pio inicializado com sucesso!");
        }

        initializeApp();
        
    } catch (error) {
        console.error("Ocorreu um erro cr√≠tico na inicializa√ß√£o do card√°pio:", error);
        document.body.innerHTML = `<div class="text-center p-8 bg-red-100 border-4 border-red-400 text-red-700 rounded-lg m-10"><h2 class="text-3xl font-bold mb-4">Opa! Algo deu muito errado.</h2><p class="text-lg">N√£o foi poss√≠vel carregar o card√°pio devido a um erro interno.</p><p class="mt-4 font-semibold">Por favor, recarregue a p√°gina ou entre em contato conosco diretamente.</p><p class="mt-2 text-sm font-mono bg-red-200 p-2 rounded">Erro: ${error.message}</p></div>`;
    }
});
</script>

</body>
</html>
